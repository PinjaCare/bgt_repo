{% extends "base.html" %}

{% block head %}
<title>Sessions</title>
{% endblock %}

{% block body %}
<h1>Game sessions</h1>

<form method="get" action="/sessions" class="mb-3">
    <label for="player_id">Filter by player:</label>
    <select name="player_id" id="player_id">
        <option value="">All players</option>
        {% for player in players %}
            <option value="{{ player.id }}"
                {% if selected_player == player.id|string %}selected{% endif %}>
                {{ player.name }}
            </option>
        {% endfor %}
    </select>
    <button type="submit">Filter</button>
</form>

<table class="table table-striped table-hover table-bordered align-middle">
    <tr>
        <th>Game</th>
        <th>Participants</th>
        <th>Winner(s)</th>
        <th>Duration</th>
        <th>Date</th>
        <th></th>
    </tr>

    {% for s in sessions %}
    <tr>
        <td>{{ s.game_name }}</td>

        <td>
            {% if s.participants %} <!-- Checks if participants list is empty or not, that is, returns true when not and false when is -->
                {{ ", ".join(s.participants) }} <!-- if returned true: lists participants separated by commas -->
            {% else %}
                -
            {% endif %}
        </td>

        <td>
            {% if s.winners %}
                {{ ", ".join(s.winners) }}
            {% else %}
                -
            {% endif %}
        </td>

        <td>
            {% if s.duration_minutes %}
                {{ s.duration_minutes }} min
            {% else %}
                -
            {% endif %}
        </td>

        <td>{{ s.date_played }}</td>

        <td>
            <form action="/delete_session/{{ s.id }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this session?');">
                <button type="submit">Delete</button>
            </form>
        </td>

    </tr>
    {% endfor %}

</table>
<a href="/add_session">Add new session</a>
{% endblock %}